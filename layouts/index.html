{{ define "main" }}
<div class="home">
    <div class="home-card">
        <div class="home-card-top">
            <div class="home-info">
                <h1>Arjun Pitchanathan</h1>
                <p class="home-blurb">Hey, I'm Arjun! I work on LLM inference. Before, I did a PhD on efficient performance modeling, mentored by Tobias Grosser. My other interests include theoretical CS, AI safety, history, dancing, philosophy of mind, and the mountains.</p>
                <p class="home-blurb">I'm always happy to <a href="mailto:mail@arjunpi.com">chat</a> about anything related to these! :)</p>
            </div>
            <div class="home-photo">
                <img src="/me.jpg" alt="Arjun Pitchanathan">
            </div>
        </div>
        <div class="home-links">
            <div class="home-link-row">
                <a href="/notes">Notes</a>
                <span class="link-sep">|</span>
                <a href="https://goodreads.com/arjunp" target="_blank">Goodreads</a>
                <span class="link-sep">|</span>
                <a href="/photography">Photos</a>
            </div>
            <div class="home-link-row">
                <a href="https://github.com/superty" target="_blank">GitHub</a>
                <span class="link-sep">|</span>
                <a href="https://arjunpi.com" id="website-link" data-click-count="0">Website</a>
                <span class="link-sep">|</span>
                <a href="https://linkedin.com/in/arjunpi" target="_blank">LinkedIn</a>
            </div>
        </div>
    </div>
</div>
<div class="home-spacer"></div>
<footer class="home-footer">
    Built with <a href="https://claude.ai/code" target="_blank">Claude</a> using <a href="https://gohugo.io" target="_blank">Hugo</a>.
</footer>

<script>
(function() {
    var emojiUrls = [
        'https://raw.githubusercontent.com/discord/twemoji/master/assets/72x72/1f61c.png',
        'https://raw.githubusercontent.com/discord/twemoji/master/assets/72x72/1f62e.png',
        'https://raw.githubusercontent.com/discord/twemoji/master/assets/72x72/1f635-200d-1f4ab.png'
    ];

    var link = document.getElementById('website-link');
    var clickCount = 0;

    var origWidth = link.offsetWidth;
    link.style.display = 'inline-block';
    link.style.width = origWidth + 'px';
    link.style.textAlign = 'center';

    // Preload emoji images
    emojiUrls.forEach(function(url) {
        var preload = new Image();
        preload.src = url;
    });

    function makeImg(url) {
        var img = document.createElement('img');
        img.src = url;
        img.style.height = '1.2em';
        img.style.gridArea = '1/1';
        return img;
    }

    function setEmoji(url) {
        while (link.firstChild) link.removeChild(link.firstChild);
        var img = makeImg(url);
        link.appendChild(img);
        link.classList.add('emoji-link');
        return img;
    }

    var origText = link.textContent;
    var origHref = link.href;

    function startAnimation() {
        link.style.display = 'inline-grid';
        link.style.placeItems = 'center';
        link.style.verticalAlign = 'middle';
        link.style.cursor = 'default';
        link.removeAttribute('href');
        clickCount = 2;

        // Crossfade ;P out and open mouth in
        var winkImg = link.querySelector('img');
        winkImg.style.animation = 'crossfadeOut 1s linear forwards';

        var shakenImg = makeImg(emojiUrls[1]);
        shakenImg.style.animation = 'crossfadeIn 1s linear forwards';
        link.appendChild(shakenImg);

        // After crossfade, spiral spins in then continues spinning
        setTimeout(function() {
            var spiralImg = setEmoji(emojiUrls[2]);
            spiralImg.style.animation = 'spinIn 2s linear forwards';
            setTimeout(function() {
                spiralImg.style.animation = 'spin 2s linear infinite';
                // Stop spinning after 20s
                setTimeout(function() {
                    spiralImg.style.animation = 'none';
                    // Crossfade back to ;P after 2s
                    setTimeout(function() {
                        var winkImg = makeImg(emojiUrls[0]);
                        winkImg.style.opacity = '0';
                        link.appendChild(winkImg);
                        // Force reflow then apply transitions
                        winkImg.offsetHeight;
                        spiralImg.style.transition = 'opacity 1s';
                        winkImg.style.transition = 'opacity 1s';
                        spiralImg.style.opacity = '0';
                        winkImg.style.opacity = '1';
                        setTimeout(function() {
                            spiralImg.remove();
                            link.style.cursor = 'pointer';
                            clickCount = 1;
                        }, 1000);
                    }, 2000);
                }, 20000);
            }, 2000);
        }, 10000);
    }

    // Click "Website" â†’ show ;P
    link.addEventListener('click', function(e) {
        if (clickCount === 0) {
            e.preventDefault();
            link.style.display = 'inline-grid';
            link.style.placeItems = 'center';
            link.style.verticalAlign = 'middle';
            setEmoji(emojiUrls[0]);
            link.style.cursor = 'pointer';
            link.removeAttribute('href');
            clickCount = 1;
        } else if (clickCount === 1) {
            e.preventDefault();
            startAnimation();
        }
    });

    // Middle click support
    link.addEventListener('auxclick', function(e) {
        if (e.button === 1) {
            e.preventDefault();
            if (clickCount === 0) {
                link.style.display = 'inline-grid';
                link.style.placeItems = 'center';
                link.style.verticalAlign = 'middle';
                setEmoji(emojiUrls[0]);
                link.style.cursor = 'pointer';
                link.removeAttribute('href');
                clickCount = 1;
            } else if (clickCount === 1) {
                startAnimation();
            }
        }
    });
})();

</script>
{{ end }}
